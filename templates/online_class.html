<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Online Class | SBA Faculty</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { 
            --google-blue: rgb(66, 133, 244); 
            --bg-deep: #0a0f1e; 
            --bg-surface: #161c2d; 
            --border: #2d3748;
        }
        body { background-color: var(--bg-deep); color: #ffffff; font-family: 'Inter', sans-serif; font-size: 13px; }
        
        .navbar { background: var(--bg-surface); border-bottom: 2px solid var(--google-blue); padding: 12px 20px; }
        .back-nav { color: var(--google-blue); text-decoration: none; font-weight: 700; font-size: 12px; }
        
        .hw-card { background: var(--bg-surface); border-radius: 16px; padding: 25px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
        
        label { color: #ffffff !important; text-transform: uppercase; font-weight: 800; font-size: 11px; margin-bottom: 8px; display: block; letter-spacing: 0.5px; }
        
        .form-control, .form-select { 
            background: #1c2539 !important; 
            border: 1px solid var(--border); 
            color: #ffffff !important; 
            border-radius: 8px; 
            height: 45px;
            font-size: 13px;
        }
        .form-control:focus { border-color: var(--google-blue); box-shadow: none; }

        .table { color: #ffffff; border-color: var(--border); }
        .table thead th { color: var(--google-blue) !important; font-size: 11px; text-transform: uppercase; border-bottom: 2px solid var(--border); }
        .table tbody td { vertical-align: middle; border-bottom: 1px solid #1e293b; padding: 12px; }

        .btn-schedule { background: var(--google-blue); color: white; border: none; font-weight: 800; padding: 12px; border-radius: 8px; text-transform: uppercase; }
        .btn-schedule:hover { background: #3367d6; }
        
        .link-text { color: #60a5fa; text-decoration: none; font-size: 11px; }
        .link-text:hover { text-decoration: underline; }
    </style>
</head>
<body>

<nav class="navbar">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <a href="/dashboard" class="back-nav me-3">← DASHBOARD</a>
            <h6 class="mb-0 fw-bold" style="letter-spacing: 1px;">SALT BROOK ACADEMY</h6>
        </div>
        <span class="badge bg-dark border border-secondary py-2 px-3">Instructor: {{ name }}</span>
    </div>
</nav>

<div class="container py-4">
    <div class="mb-4">
        <h4 class="fw-bold mb-1">Online Class Scheduler</h4>
        <p class="text-info small">Schedule Zoom/Meet sessions for Class XI & XII</p>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} bg-dark text-white border-{{ category }} small">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="row g-4">
        <div class="col-lg-4">
            <div class="hw-card">
                <form action="/online_class" method="POST">
                    <div class="mb-3">
                        <label>Date of Class</label>
                        <input type="date" name="class_date" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label>Start Time</label>
                        <input type="time" name="class_time" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label>Select Class</label>
                        <select name="student_class" class="form-select">
                            <option value="XI">Class XI</option>
                            <option value="XII">Class XII</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label>Meeting Link (Zoom/Google Meet)</label>
                        <input type="url" name="zoom_link" class="form-control" placeholder="https://zoom.us/j/..." required>
                    </div>
                    <button type="submit" class="btn btn-schedule w-100 mt-2">Schedule Class</button>
                </form>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="hw-card p-0 overflow-hidden">
                <div class="p-3 bg-dark bg-opacity-25 border-bottom border-dark">
                    <h6 class="mb-0 small fw-bold text-google-blue">Your Scheduled Sessions</h6>
                </div>
                <div class="table-responsive">
                    <table class="table mb-0">
                        <thead>
                            <tr>
                                <th class="ps-4">Date & Time</th>
                                <th>Target</th>
                                <th>Meeting URL</th>
                                <th class="text-end pe-4">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for c in history %}
                            <tr>
                                <td class="ps-4">
                                    <div class="fw-bold">{{ c.class_time.strftime('%d %b %Y') if c.class_time is not string else c.class_time }}</div>
                                    <div class="small text-muted">{{ c.class_time.strftime('%I:%M %p') if c.class_time is not string else '' }}</div>
                                </td>
                                <td><span class="badge bg-secondary">Class {{ c.student_class }}</span></td>
                                <td><a href="{{ c.zoom_link }}" target="_blank" class="link-text">Join Meeting ↗</a></td>
                                <td class="text-end pe-4">
                                    <span class="badge bg-success bg-opacity-10 text-success border border-success px-2 py-1" style="font-size: 9px;">SCHEDULED</span>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center py-5 text-muted italic">No classes scheduled yet.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Material | SBA Faculty</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --google-blue: rgb(66, 133, 244); --bg-deep: #0a0f1e; --bg-surface: #161c2d; }
        body { background-color: var(--bg-deep); color: #ffffff; font-family: 'Inter', sans-serif; font-size: 13px; }
        
        .navbar { background: var(--bg-surface); border-bottom: 2px solid var(--google-blue); padding: 10px 20px; }
        .back-nav { color: var(--google-blue); text-decoration: none; font-weight: 600; font-size: 13px; }
        
        /* Typography - Force all text and labels to White */
        h4, h6, label, .form-label, .text-muted, p { color: #ffffff !important; }
        .text-google-blue { color: var(--google-blue) !important; }

        .hw-card { background: var(--bg-surface); border-radius: 16px; padding: 25px; border: 1px solid #2d3748; box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
        
        /* Input & Select Styling */
        .form-control, .form-select { 
            background: #1c2539; 
            border: 1px solid #2d3748; 
            color: #ffffff !important; /* Text inside boxes */
            font-size: 13px; 
            border-radius: 8px; 
            height: 45px;
        }
        
        /* Ensure dropdown options are readable */
        .form-select option {
            background: #161c2d;
            color: #ffffff;
        }

        .form-control::placeholder { color: #94a3b8; }
        .form-control:focus, .form-select:focus { 
            border-color: var(--google-blue); 
            box-shadow: none; 
            background: #1c2539; 
            color: white; 
        }
        
        .table { color: #ffffff; border-color: #2d3748; }
        .table thead { background: rgba(66, 133, 244, 0.1); color: var(--google-blue); font-size: 11px; }
        .table thead th { color: var(--google-blue) !important; }
        
        .btn-upload { background: var(--google-blue); color: white; font-weight: 800; border: none; border-radius: 8px; height: 45px; transition: 0.3s; }
        .btn-upload:hover { background: #3367d6; color: white; transform: translateY(-1px); }

        .resource-link { text-decoration: none; font-weight: 700; font-size: 11px; padding: 5px 12px; border-radius: 6px; display: inline-flex; align-items: center; gap: 5px; }
        .link-pdf { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.4); }
        .link-video { background: rgba(66, 133, 244, 0.2); color: #93c5fd; border: 1px solid rgba(66, 133, 244, 0.4); }
    </style>
</head>
<body>

<nav class="navbar">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <a href="/dashboard" class="back-nav me-3">‚Üê DASHBOARD</a>
            <h6 class="mb-0 fw-bold">SALT BROOK ACADEMY</h6>
        </div>
        <span class="badge bg-dark border border-secondary text-white">Instructor: {{ name }}</span>
    </div>
</nav>

<div class="container py-4">
    <div class="mb-4">
        <h4 class="fw-bold mb-1">Study Material</h4>
        <p class="small">Upload resources for <span class="fw-bold text-info">{{ dept }}</span></p>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} bg-dark border-{{ category }} text-white small">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="hw-card mb-4">
        <form action="/study_material" method="POST" enctype="multipart/form-data">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="small mb-1 d-block text-uppercase fw-bold">Topic / Subject</label>
                    <input type="text" name="topic" class="form-control" placeholder="e.g. Organic Chemistry Part 1" required>
                </div>
                <div class="col-md-2">
                    <label class="small mb-1 d-block text-uppercase fw-bold">Target Class</label>
                    <select name="student_class" class="form-select" required>
                        <option value="XI">Class XI</option>
                        <option value="XII">Class XII</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="small mb-1 d-block text-uppercase fw-bold">YouTube URL</label>
                    <input type="url" name="youtube_link" class="form-control" placeholder="https://youtube.com/...">
                </div>
                <div class="col-md-3">
                    <label class="small mb-1 d-block text-uppercase fw-bold">Upload PDF</label>
                    <input type="file" name="pdf_file" class="form-control" accept=".pdf">
                </div>
                <div class="col-12 mt-4 text-end">
                    <button type="submit" class="btn btn-upload px-5">PUBLISH MATERIAL</button>
                </div>
            </div>
        </form>
    </div>

    <div class="hw-card p-0 overflow-hidden">
        <div class="p-3 border-bottom border-dark bg-dark bg-opacity-25">
            <h6 class="mb-0 fw-bold small text-uppercase text-google-blue">Recent Uploads</h6>
        </div>
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th class="ps-4">Date Uploaded</th>
                    <th>Topic</th>
                    <th>Class</th>
                    <th>Resources</th>
                </tr>
            </thead>
            <tbody>
                {% for item in materials %}
                <tr class="align-middle border-bottom border-dark">
                    <td class="ps-4">
                        <div class="fw-bold text-white">{{ item.uploaded_at.strftime('%d %b, %Y') }}</div>
                        <div class="small opacity-75">{{ item.uploaded_at.strftime('%I:%M %p') }}</div>
                    </td>
                    <td class="fw-bold">{{ item.subject_topic }}</td>
                    <td><span class="badge bg-primary border border-info">CL {{ item.student_class }}</span></td>
                    <td>
                        <div class="d-flex gap-2">
                            {% if item.pdf_filename %}
                                <a href="{{ url_for('static', filename='uploads/study_materials/' + item.pdf_filename) }}" target="_blank" class="resource-link link-pdf">
                                    PDF
                                </a>
                            {% endif %}
                            
                            {% if item.youtube_link %}
                                <a href="{{ item.youtube_link }}" target="_blank" class="resource-link link-video">
                                    VIDEO
                                </a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" class="text-center py-5 text-white opacity-50 italic">No materials uploaded yet. Use the form above to start.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>